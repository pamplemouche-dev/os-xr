<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Gemini OS - Force Axis</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; touch-action: none; }
        #boot-loader {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 10000;
            color: #8ab4f8; font-family: sans-serif; transition: opacity 1s ease;
        }
    </style>
</head>
<body>

    <div id="boot-loader">
        <p>FORÇAGE DES AXES SPATIAUX...</p>
    </div>

    <a-scene vr-mode-ui="enabled: false">
        <a-sky color="#02050a"></a-sky>
        
        <a-entity id="camera-rig">
            <a-camera id="main-cam" look-controls="enabled: false" wasd-controls-enabled="false">
                <a-cursor color="#8ab4f8"></a-cursor>
            </a-camera>
        </a-entity>

        <a-entity id="main-menu" visible="false" position="0 1.5 -2.5">
            <a-plane width="3" height="1" color="#fff" opacity="0.1" material="transparent: true"></a-plane>
            <a-circle radius="0.4" color="#4285f4" onclick="openGemini()">
                <a-text value="GEMINI" align="center" width="4"></a-text>
            </a-circle>
        </a-entity>

        <a-sphere position="0 5 -5" radius="0.5" color="red"><a-text value="PLAFOND" align="center" position="0 -1 0"></a-text></a-sphere>
        <a-sphere position="0 -5 -5" radius="0.5" color="blue"><a-text value="SOL" align="center" position="0 1 0"></a-text></a-sphere>

    </a-scene>

    <script>
        const cam = document.getElementById('main-cam');
        const boot = document.getElementById('boot-loader');
        const menu = document.getElementById('main-menu');

        // Variables pour le contrôle manuel
        let pitch = 0; // Haut/Bas
        let yaw = 0;   // Gauche/Droite
        let isTouching = false;
        let lastTouchY = 0;
        let lastTouchX = 0;

        // Sensibilité (ajuste si c'est trop rapide ou lent)
        const sensitivity = 0.2;

        window.onload = () => {
            setTimeout(() => {
                boot.style.opacity = '0';
                setTimeout(() => { boot.style.display = 'none'; menu.setAttribute('visible', 'true'); }, 1000);
            }, 2000);
        };

        // ÉCOUTE DU TOUCHER IPAD
        window.addEventListener('touchstart', (e) => {
            isTouching = true;
            lastTouchX = e.touches[0].clientX;
            lastTouchY = e.touches[0].clientY;
        });

        window.addEventListener('touchend', () => { isTouching = false; });

        window.addEventListener('touchmove', (e) => {
            if (!isTouching) return;

            let deltaX = e.touches[0].clientX - lastTouchX;
            let deltaY = e.touches[0].clientY - lastTouchY;

            lastTouchX = e.touches[0].clientX;
            lastTouchY = e.touches[0].clientY;

            // Calcul de la nouvelle rotation
            yaw -= deltaX * sensitivity;
            pitch -= deltaY * sensitivity;

            // Limiter le mouvement vertical pour ne pas faire de salto arrière (90° max)
            pitch = Math.max(-90, Math.min(90, pitch));

            // Appliquer la rotation à la caméra
            cam.setAttribute('rotation', `${pitch} ${yaw} 0`);
            
            e.preventDefault(); // Empêche le scroll Safari
        }, { passive: false });

        function openGemini() {
            alert("Gemini activé ! (L'IA t'écoute)");
        }
    </script>
</body>
</html>
